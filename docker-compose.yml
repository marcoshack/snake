version: '3.8'

services:
  snake:
    image: ghcr.io/marcoshack/snake:latest
    container_name: snake
    environment:
      # Anthropic API key for accessing Claude models
      ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY}

      # OpenSearch connection for fetching Rust server logs
      OPENSEARCH_HOST: ${OPENSEARCH_HOST}
      OPENSEARCH_PORT: ${OPENSEARCH_PORT:-9200}
      OPENSEARCH_USER: ${OPENSEARCH_USER}
      OPENSEARCH_PASSWORD: ${OPENSEARCH_PASSWORD}
      OPENSEARCH_INDEX: ${OPENSEARCH_INDEX}
      OPENSEARCH_RESULT_SIZE: ${OPENSEARCH_RESULT_SIZE:-10000}

      # Discord webhook for posting admin alerts
      DISCORD_RUST_ADMIN_WEBHOOK: ${DISCORD_RUST_ADMIN_WEBHOOK}

      # Directory where HTML reports are saved (container path)
      SNAKE_REPORT_OUTPUT_DIR: /app/reports

    volumes:
      # Mount host directory to container's /app/reports
      - ${HOST_REPORT_DIR:-./reports}:/app/reports

    restart: unless-stopped
